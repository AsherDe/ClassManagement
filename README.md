# çŸ³æ²³å­å¤§å­¦ç­çº§äº‹åŠ¡ç®¡ç†ç³»ç»Ÿ

[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-17-blue.svg)](https://www.postgresql.org/)
[![Node.js](https://img.shields.io/badge/Node.js-16+-green.svg)](https://nodejs.org/)
[![Vue.js](https://img.shields.io/badge/Vue.js-3.3+-brightgreen.svg)](https://vuejs.org/)
[![Element Plus](https://img.shields.io/badge/Element%20Plus-2.4+-blue.svg)](https://element-plus.org/)

## é¡¹ç›®æ¦‚è¿°

çŸ³æ²³å­å¤§å­¦ç­çº§äº‹åŠ¡ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäº PostgreSQL æ•°æ®åº“çš„è¯¾ç¨‹è®¾è®¡é¡¹ç›®ï¼Œæ—¨åœ¨å±•ç¤ºæ•°æ®åº“è®¾è®¡èƒ½åŠ›å’Œ SQL ç¼–ç¨‹æŠ€èƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨ç°ä»£åŒ–çš„æŠ€æœ¯æ ˆï¼ŒåŒ…å«å®Œæ•´çš„å‰åç«¯å®ç°ã€‚

### ç³»ç»Ÿç‰¹è‰²

- ğŸ—ï¸ **æ•°æ®åº“é©±åŠ¨**: ä»¥ PostgreSQL é«˜çº§ç‰¹æ€§ä¸ºæ ¸å¿ƒ
- ğŸ“Š **å¤æ‚æŸ¥è¯¢**: å¤§é‡ä½¿ç”¨çª—å£å‡½æ•°ã€CTEã€å­˜å‚¨è¿‡ç¨‹
- âš¡ **æ€§èƒ½ä¼˜åŒ–**: ç´¢å¼•ä¼˜åŒ–ã€è§†å›¾ç¼“å­˜ã€æŸ¥è¯¢ä¼˜åŒ–
- ğŸ”„ **è‡ªåŠ¨åŒ–**: è§¦å‘å™¨å®ç°æ•°æ®å®Œæ•´æ€§å’Œè‡ªåŠ¨æ›´æ–°
- ğŸ“ˆ **æ•°æ®åˆ†æ**: ä¸°å¯Œçš„ç»Ÿè®¡æŠ¥è¡¨å’Œå¯è§†åŒ–å›¾è¡¨
- ğŸ¯ **å®ç”¨æ€§**: è´´è¿‘çœŸå®çš„ç­çº§ç®¡ç†ä¸šåŠ¡åœºæ™¯

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **æ•°æ®åº“**: PostgreSQL 17
- **è¿è¡Œæ—¶**: Node.js 16+
- **æ¡†æ¶**: Express.js
- **æ•°æ®åº“é©±åŠ¨**: pg (åŸç”Ÿ PostgreSQL é©±åŠ¨)
- **å®‰å…¨**: bcrypt, jsonwebtoken, helmet
- **éªŒè¯**: express-validator
- **æ—¥å¿—**: winston

### å‰ç«¯æŠ€æœ¯
- **æ¡†æ¶**: Vue.js 3.3+
- **UIç»„ä»¶**: Element Plus 2.4+
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router 4
- **å›¾è¡¨**: ECharts + vue-echarts
- **æ„å»ºå·¥å…·**: Vite
- **æ ·å¼**: SCSS

### æ•°æ®åº“ç‰¹æ€§
- âœ… **çª—å£å‡½æ•°**: å­¦ç”Ÿæ’åã€æˆç»©ç»Ÿè®¡
- âœ… **å­˜å‚¨è¿‡ç¨‹**: æ‰¹é‡æ•°æ®å¤„ç†ã€å¤æ‚ä¸šåŠ¡é€»è¾‘
- âœ… **è§¦å‘å™¨**: æ•°æ®å®Œæ•´æ€§ã€è‡ªåŠ¨æ›´æ–°
- âœ… **è§†å›¾**: å¤æ‚æŸ¥è¯¢ä¼˜åŒ–ã€æ•°æ®å®‰å…¨
- âœ… **ç´¢å¼•**: B-treeã€éƒ¨åˆ†ç´¢å¼•ã€å¤åˆç´¢å¼•
- âœ… **çº¦æŸ**: ä¸»é”®ã€å¤–é”®ã€æ£€æŸ¥çº¦æŸã€å”¯ä¸€çº¦æŸ
- âœ… **CTEæŸ¥è¯¢**: é€’å½’æŸ¥è¯¢ã€å¤æ‚ç»Ÿè®¡
- âœ… **JSONå­—æ®µ**: çµæ´»æ•°æ®å­˜å‚¨
- âœ… **æ•°ç»„ç±»å‹**: PostgreSQL ç‰¹æœ‰åŠŸèƒ½

## ç³»ç»ŸåŠŸèƒ½

### æ ¸å¿ƒæ¨¡å—

#### 1. ç”¨æˆ·ç®¡ç†æ¨¡å—
- å­¦ç”Ÿä¿¡æ¯ç®¡ç†ï¼ˆåŸºæœ¬ä¿¡æ¯ã€å­¦ä¸šæƒ…å†µï¼‰
- æ•™å¸ˆä¿¡æ¯ç®¡ç†ï¼ˆæ•™å­¦ä»»åŠ¡ã€å·¥ä½œé‡ç»Ÿè®¡ï¼‰
- ç­çº§å¹²éƒ¨ç®¡ç†ï¼ˆç­é•¿ã€å‰¯ç­é•¿æƒé™ï¼‰
- æƒé™åˆ†çº§æ§åˆ¶ï¼ˆè§’è‰²æƒé™ã€æ“ä½œæˆæƒï¼‰

#### 2. ç­çº§äº‹åŠ¡æ¨¡å—
- ç­çº§åŸºæœ¬ä¿¡æ¯ç®¡ç†
- ç­çº§æ´»åŠ¨ç»„ç»‡ç®¡ç†
- ç­è´¹æ”¶æ”¯ç®¡ç†ï¼ˆå®¡æ‰¹æµç¨‹ï¼‰
- è€ƒå‹¤ç®¡ç†ï¼ˆè¯¾ç¨‹è€ƒå‹¤ã€æ´»åŠ¨è€ƒå‹¤ï¼‰

#### 3. å­¦ä¸šç®¡ç†æ¨¡å—
- è¯¾ç¨‹ä¿¡æ¯ç®¡ç†
- è¯¾ç¨‹å®‰æ’ç®¡ç†ï¼ˆæ—¶é—´å†²çªæ£€æµ‹ï¼‰
- æˆç»©å½•å…¥æŸ¥è¯¢ï¼ˆæ‰¹é‡å¯¼å…¥ã€ç»Ÿè®¡åˆ†æï¼‰
- å­¦åˆ†ç»Ÿè®¡ï¼ˆGPAè®¡ç®—ã€æ’åï¼‰

#### 4. æ•°æ®åˆ†ææ¨¡å—
- æˆç»©åˆ†ææŠ¥å‘Šï¼ˆåˆ†å¸ƒç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æï¼‰
- è€ƒå‹¤ç»Ÿè®¡åˆ†æï¼ˆå‡ºå‹¤ç‡ã€å¼‚å¸¸æ£€æµ‹ï¼‰
- ç­çº§ç»©æ•ˆè¯„ä¼°ï¼ˆç»¼åˆæ’åï¼‰
- è´¢åŠ¡ç»Ÿè®¡æŠ¥è¡¨ï¼ˆæ”¶æ”¯æ˜ç»†ã€ä½™é¢ç»Ÿè®¡ï¼‰

### é«˜çº§åŠŸèƒ½

#### SQL å¤æ‚æŸ¥è¯¢ç¤ºä¾‹
```sql
-- ä½¿ç”¨çª—å£å‡½æ•°è®¡ç®—å­¦ç”Ÿæˆç»©æ’å
SELECT 
    student_id, student_name, total_score,
    ROW_NUMBER() OVER (PARTITION BY class_id ORDER BY total_score DESC) as class_rank,
    RANK() OVER (ORDER BY total_score DESC) as overall_rank
FROM v_student_grade_summary;

-- ä½¿ç”¨ CTE è¿›è¡Œé€’å½’æŸ¥è¯¢ï¼ˆæƒé™ç»§æ‰¿ï¼‰
WITH RECURSIVE permission_tree AS (
    SELECT id, permission_name, parent_id, 1 as level
    FROM permissions WHERE parent_id IS NULL
    UNION ALL
    SELECT p.id, p.permission_name, p.parent_id, pt.level + 1
    FROM permissions p
    JOIN permission_tree pt ON p.parent_id = pt.id
)
SELECT * FROM permission_tree;

-- å­˜å‚¨è¿‡ç¨‹è°ƒç”¨ç¤ºä¾‹
CALL batch_import_grades(1, '2024-1', '2024-2025', 
    ARRAY[(1001,85.0,88.0,90.0), (1002,90.0,92.0,95.0)]::grades_data[]);
```

## å®‰è£…éƒ¨ç½²

### ç¯å¢ƒè¦æ±‚
- PostgreSQL 17+
- Node.js 16+
- npm 8+

### å¿«é€Ÿå¼€å§‹

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd class_management
```

2. **æ•°æ®åº“åˆå§‹åŒ–**
```bash
# åˆ›å»ºæ•°æ®åº“
createdb class_management_system

# æ‰§è¡Œæ•°æ®åº“è„šæœ¬
psql -d class_management_system -f database/schema/01_create_tables.sql
psql -d class_management_system -f database/indexes/02_create_indexes.sql
psql -d class_management_system -f database/schema/03_create_views.sql
psql -d class_management_system -f database/procedures/04_stored_procedures.sql
psql -d class_management_system -f database/triggers/05_create_triggers.sql
psql -d class_management_system -f database/data/06_insert_test_data.sql
```

3. **åç«¯å¯åŠ¨**
```bash
cd backend
npm install
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶é…ç½®æ•°æ®åº“è¿æ¥
npm run dev
```

4. **å‰ç«¯å¯åŠ¨**
```bash
cd frontend
npm install
npm run dev
```

5. **è®¿é—®ç³»ç»Ÿ**
- å‰ç«¯åœ°å€: http://localhost:8080
- åç«¯API: http://localhost:3000
- APIæ–‡æ¡£: http://localhost:3000/api

### ç”Ÿäº§éƒ¨ç½²

1. **ç¯å¢ƒé…ç½®**
```bash
# åç«¯ç”Ÿäº§æ„å»º
cd backend
npm run build

# å‰ç«¯ç”Ÿäº§æ„å»º
cd frontend
npm run build:prod
```

2. **æ•°æ®åº“é…ç½®**
```sql
-- åˆ›å»ºç”Ÿäº§æ•°æ®åº“ç”¨æˆ·
CREATE USER class_mgmt_user WITH PASSWORD 'your_secure_password';
GRANT ALL PRIVILEGES ON DATABASE class_management_system TO class_mgmt_user;
```

3. **Nginx é…ç½®ç¤ºä¾‹**
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        root /path/to/frontend/dist;
        try_files $uri $uri/ /index.html;
    }
    
    location /api {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

| è¡¨å | è¯´æ˜ | ä¸»è¦å­—æ®µ |
|------|------|----------|
| users | ç”¨æˆ·åŸºç¡€è¡¨ | id, username, user_type, profile_data(JSON) |
| students | å­¦ç”Ÿä¿¡æ¯è¡¨ | student_code, name, class_id, gpa, total_credits |
| teachers | æ•™å¸ˆä¿¡æ¯è¡¨ | teacher_code, name, department, title |
| classes | ç­çº§ä¿¡æ¯è¡¨ | class_name, class_code, monitor_id, class_fund_balance |
| courses | è¯¾ç¨‹ä¿¡æ¯è¡¨ | course_code, course_name, credits, course_type |
| grades | æˆç»©è®°å½•è¡¨ | student_id, course_id, total_score, grade_point |
| attendance | è€ƒå‹¤è®°å½•è¡¨ | student_id, attendance_date, status |
| class_activities | ç­çº§æ´»åŠ¨è¡¨ | activity_name, start_time, participant_count |
| class_funds | ç­è´¹è®°å½•è¡¨ | transaction_type, amount, status |
| notifications | é€šçŸ¥å…¬å‘Šè¡¨ | title, content, target_type, attachment_urls(Array) |

### å…³é”®è§†å›¾

- `v_student_grade_summary`: å­¦ç”Ÿæˆç»©æ±‡æ€»ï¼ˆå«æ’åã€GPAï¼‰
- `v_class_activity_summary`: ç­çº§æ´»åŠ¨ç»Ÿè®¡
- `v_attendance_statistics`: è€ƒå‹¤ç»Ÿè®¡åˆ†æ
- `v_class_fund_summary`: ç­è´¹æ”¶æ”¯æ±‡æ€»
- `v_teacher_workload`: æ•™å¸ˆå·¥ä½œé‡ç»Ÿè®¡

### å­˜å‚¨è¿‡ç¨‹

- `calculate_gpa(student_id)`: è®¡ç®—å­¦ç”ŸGPA
- `batch_import_grades()`: æ‰¹é‡å¯¼å…¥æˆç»©
- `get_course_grade_statistics()`: è¯¾ç¨‹æˆç»©ç»Ÿè®¡
- `get_class_performance_ranking()`: ç­çº§ç»©æ•ˆæ’å

## API æ¥å£

### å­¦ç”Ÿç®¡ç†
```http
GET    /api/students                    # è·å–å­¦ç”Ÿåˆ—è¡¨
GET    /api/students/:id               # è·å–å­¦ç”Ÿè¯¦æƒ…
GET    /api/students/:id/transcript    # è·å–å­¦ç”Ÿæˆç»©å•
PUT    /api/students/:id               # æ›´æ–°å­¦ç”Ÿä¿¡æ¯
POST   /api/students/import            # æ‰¹é‡å¯¼å…¥å­¦ç”Ÿ
```

### æˆç»©ç®¡ç†
```http
GET    /api/grades                     # è·å–æˆç»©åˆ—è¡¨
POST   /api/grades                     # å½•å…¥æˆç»©
POST   /api/grades/batch-import        # æ‰¹é‡å¯¼å…¥æˆç»©
GET    /api/grades/course/:id/statistics/:semester/:year  # è¯¾ç¨‹ç»Ÿè®¡
```

### ç³»ç»Ÿä¿¡æ¯
```http
GET    /api/health                     # å¥åº·æ£€æŸ¥
GET    /api/db-info                    # æ•°æ®åº“ä¿¡æ¯
GET    /api                           # APIæ¦‚è§ˆ
```

## æ€§èƒ½ä¼˜åŒ–

### ç´¢å¼•ç­–ç•¥
- **B-treeç´¢å¼•**: ä¸»é”®ã€å¤–é”®ã€å¸¸ç”¨æŸ¥è¯¢å­—æ®µ
- **å¤åˆç´¢å¼•**: å¤šå­—æ®µè”åˆæŸ¥è¯¢ä¼˜åŒ–
- **éƒ¨åˆ†ç´¢å¼•**: æ¡ä»¶è¿‡æ»¤ç´¢å¼•
- **å‡½æ•°ç´¢å¼•**: è®¡ç®—å­—æ®µç´¢å¼•

### æŸ¥è¯¢ä¼˜åŒ–
- **è§†å›¾ç¼“å­˜**: å¤æ‚æŸ¥è¯¢ç»“æœç¼“å­˜
- **å­˜å‚¨è¿‡ç¨‹**: å‡å°‘ç½‘ç»œä¼ è¾“
- **çª—å£å‡½æ•°**: é¿å…å­æŸ¥è¯¢
- **CTE**: ç®€åŒ–å¤æ‚é€»è¾‘

### æ€§èƒ½ç›‘æ§
```sql
-- æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ
SELECT schemaname, tablename, indexname, idx_scan, idx_tup_read
FROM pg_stat_user_indexes 
ORDER BY idx_scan DESC;

-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SELECT query, mean_time, calls, total_time
FROM pg_stat_statements 
ORDER BY mean_time DESC;
```

## å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ
- éµå¾ª ESLint è§„åˆ™
- ä½¿ç”¨ Prettier æ ¼å¼åŒ–
- ç»„ä»¶å‘½åé‡‡ç”¨ PascalCase
- æ–‡ä»¶å‘½åé‡‡ç”¨ kebab-case

### æ•°æ®åº“å¼€å‘
- æ‰€æœ‰è¡¨å¿…é¡»æœ‰ä¸»é”®å’Œæ—¶é—´æˆ³
- å¤–é”®çº¦æŸå¿…é¡»æ˜ç¡®å‘½å
- å¤æ‚æŸ¥è¯¢ä¼˜å…ˆä½¿ç”¨è§†å›¾
- ä¸šåŠ¡é€»è¾‘ä¼˜å…ˆä½¿ç”¨å­˜å‚¨è¿‡ç¨‹

### Git æäº¤è§„èŒƒ
```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤é—®é¢˜
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»ºå·¥å…·ã€è¾…åŠ©å·¥å…·ç­‰
```

## å¸¸è§é—®é¢˜

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ
A: æ£€æŸ¥ PostgreSQL æœåŠ¡çŠ¶æ€å’Œè¿æ¥é…ç½®ï¼Œç¡®ä¿æ•°æ®åº“å·²åˆ›å»ºä¸”ç”¨æˆ·æƒé™æ­£ç¡®ã€‚

### Q: å‰ç«¯é¡µé¢ç©ºç™½ï¼Ÿ
A: æ£€æŸ¥ API ä»£ç†é…ç½®ï¼Œç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨ä¸”ç«¯å£æ­£ç¡®ã€‚

### Q: æˆç»©å¯¼å…¥å¤±è´¥ï¼Ÿ
A: æ£€æŸ¥æ•°æ®æ ¼å¼æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œå­¦ç”ŸIDå’Œè¯¾ç¨‹IDæ˜¯å¦å­˜åœ¨ã€‚

### Q: æƒé™éªŒè¯ä¸é€šè¿‡ï¼Ÿ
A: æ£€æŸ¥ç”¨æˆ·æƒé™é…ç½®ï¼Œç¡®ä¿æƒé™è¡¨æ•°æ®æ­£ç¡®ã€‚

## è®¸å¯è¯

Apache License

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“è¯¾ç¨‹è®¾è®¡é¡¹ç›®ï¼Œä¸»è¦ç”¨äºå±•ç¤º PostgreSQL æ•°æ®åº“è®¾è®¡èƒ½åŠ›å’Œ SQL ç¼–ç¨‹æŠ€èƒ½ã€‚